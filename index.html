<!DOCTYPE HTML>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Regular simplices in Q^n</title>
    <script src="https://sagecell.sagemath.org/static/embedded_sagecell.js"></script>
    <script>
    // Make the div with id 'mycell' a Sage cell
    sagecell.makeSagecell({inputLocation:  '#mycell',
                           //template:       sagecell.templates.minimal,
                           //width:0.5*device-width,
                           evalButtonText: 'Activate'});
    // Make *any* div with class 'compute' a Sage cell
    sagecell.makeSagecell({inputLocation: 'div.compute',
                           evalButtonText: 'Evaluate'});
    </script>
  </head>
  <body>


<h2>Regular simplices in Q^n</h2>
    <div id="mycell" ><script type="text/x-sage" >
#@interact
#import itertools
#from sage.all import *
from math import *

def E(n, r=1): # returns identity forms of rank n
	return DiagonalQuadraticForm(QQ, [r]*n)

def S(n): # returns quadratic form related to regular simplex on (n+1) vertices 
	return DiagonalQuadraticForm(QQ, [i*(i+1)/2 for i in range(1, n+1)])

def Coord(n):  # gives coordinates of cliques in S(n) quadratic form
	if n == 0:
		return [vector([])]
	if n == 1:
		return [vector([0]), vector([1])]
	X = Coord(n - 1)
	X = [ vector(list(i) + [0])  for i in X]
	v = sum(X) / n
	#print(X, v)
	x = sum([i*(i+1)/2 * v[i-1]**2 for i in range(1, n+1)])
	v[-1] = sqrt((1 - x) /  (n*(n+1)/2)  )
	return X + [v]




def is_embeddable(M, N): # checks if 
	k = N.dim() - M.dim()
	if k < 0:
		return False
	P = []
	ND = squarefree_part(N.Gram_det())
	MD = squarefree_part(M.Gram_det())
	D = squarefree_part(ND * MD)
	if k == 0:
		# исправить для правильных p
 		return D == 1 and all([  M.hasse_invariant(p) == N.hasse_invariant(p)  for p in [-1] + list(prime_range(10**2))]) 
 
	for p in [-1] + list(prime_range(10**2)):
		# исправить для правильных p
		if M.hasse_invariant(p) * N.hasse_invariant(p) * hilbert_symbol(MD, D, p) == -1:
			P.append(p)
		try:
			#print(k)
			DD = quadratic_form_from_invariants(QQ,k, D, P, 0)
			return True, DD
		except ValueError:
			return False


def w(M):
	k = M.dim()
	while not is_embeddable(S(k), M):
		k -= 1
	return k + 1

def t(n):
    return (n + 1) // (2**(n % 2))

'''
for p in [-1] + list(prime_range(2, 51)):
    x = 1
    for n in range(1, 51):
        print(S(n).hasse_invariant(p), end = ' ')
    print()
    for n in range(1, 51):
        print(hilbert_symbol(n + 1, t(n-1), p), end = ' ')
    print()
    print()
'''

n = 5
X = Coord(n)
print(*X)
S = [i*(i+1)/2 for i in range(1, n+1)]
for i in range(len(X)):
	for j in range(i + 1, len(X)):
		x = X[i] - X[j]
		print(sum([S[i]*x[i]**2 for i in range(n)]), end = ' ')
</script></div>



<footer style="margin-top: 300px;">
	<center>
		<br> Made by Artemy Sokolov, MIPT	
		<!--
		<br> Powered by SageMathCell
		-->
	</center>
</footer>


  </body>
</html>
